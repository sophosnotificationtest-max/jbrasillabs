<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JBrasil Labs - Sophos Specialist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Orbitron', sans-serif; cursor: none; }
        
        /* Jogo Fullscreen */
        #game-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        #game-canvas { width: 100%; height: 100%; }

        /* HUD Superior */
        .hud { position: fixed; top: 20px; left: 20px; z-index: 100; font-family: 'Press Start 2P', cursive; font-size: 10px; color: #00ff00; pointer-events: none; text-shadow: 0 0 10px #00ff00; line-height: 2.5; }
        
        /* Controles e Especialidade */
        .controls { position: fixed; top: 20px; right: 20px; z-index: 200; display: flex; flex-direction: column; align-items: flex-end; gap: 10px; cursor: default; }
        .action-btn { 
            border: 1px solid #00ff00; 
            padding: 10px 20px; 
            font-family: 'Press Start 2P', cursive; 
            font-size: 9px; 
            color: #00ff00; 
            background: rgba(0,255,0,0.1); 
            transition: 0.3s;
            cursor: pointer;
            text-align: center;
            width: 220px;
        }
        .action-btn:hover { background: #00ff00; color: #000; box-shadow: 0 0 20px #00ff00; }
        .sophos-tag { font-family: 'Orbitron'; font-size: 10px; color: #4e9eff; letter-spacing: 2px; text-transform: uppercase; border-right: 3px solid #4e9eff; padding-right: 10px; }

        /* Tela de In√≠cio */
        #start-screen { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; z-index: 300; transition: opacity 0.5s; width: 90%; }
        #main-logo { width: 550px; max-width: 90%; filter: drop-shadow(0 0 30px #00ff00); cursor: pointer; margin-bottom: 30px; }
        .start-prompt { font-family: 'Press Start 2P', cursive; font-size: 16px; color: #00ff00; animation: blink 1s infinite; cursor: pointer; }
        .sub-text { color: #888; font-size: 12px; margin-top: 15px; letter-spacing: 4px; }

        /* Rodap√© de Identifica√ß√£o */
        #footer-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,20,0,0.8); border-top: 1px solid #00ff0033; padding: 10px 20px; z-index: 100; display: flex; justify-content: space-between; align-items: center; pointer-events: none; }
        .branding { font-size: 11px; color: #00ff00; font-weight: bold; letter-spacing: 1px; }

        /* Terminal */
        #terminal { position: fixed; bottom: 50px; left: 15px; font-family: monospace; z-index: 150; color: #00ff00; width: 45%; max-height: 100px; overflow: hidden; pointer-events: none; }
        .terminal-line { background: rgba(0,0,0,0.8); margin-bottom: 2px; padding: 3px 8px; font-size: 10px; border-left: 2px solid #00ff00; }

        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
    </style>
</head>
<body>

<div id="footer-bar">
    <div class="branding">JBRASIL LABS // NETWORK DEFENSE</div>
    <div class="sophos-tag">SOPHOS CERTIFIED SPECIALIST</div>
</div>

<div id="terminal"></div>

<div class="controls" id="ui-controls" style="display: none;">
    <button class="action-btn" onclick="window.open('mailto:jonas.brasil@jbrasillabs.com.br')">CONTACT EXPERT</button>
    <button class="action-btn" style="font-size: 7px; opacity: 0.7;" onclick="systemReboot()">SYSTEM RESET</button>
</div>

<div class="hud" id="hud" style="display: none;">
    CORE_SCORE: <span id="score">0000</span><br>
    BREACHES: <span id="leaks">0</span>/10
</div>

<div id="game-container">
    <canvas id="game-canvas"></canvas>
</div>

<div id="start-screen">
    <img src="https://raw.githubusercontent.com/sophosnotificationtest-max/jbrasillabs/main/logo.png" id="main-logo" alt="JBrasil Labs">
    <div class="start-prompt" id="start-btn">INITIALIZE SYSTEM</div>
    <div class="sub-text">SOPHOS CYBERSECURITY SOLUTIONS</div>
</div>

<script>
const canvas = document.getElementById('game-canvas');
const ctx = canvas.getContext('2d');
let score = 0, leaks = 0, enemies = [], bullets = [], gameActive = false;
let mouseX = window.innerWidth / 2, mouseY = window.innerHeight / 2;

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resize); resize();
window.addEventListener('mousemove', (e) => { mouseX = e.clientX; mouseY = e.clientY; });

function drawShip(x, y) {
    ctx.save(); ctx.translate(x, y);
    ctx.strokeStyle = "#00ff00"; ctx.lineWidth = 2; ctx.shadowBlur = 15; ctx.shadowColor = "#00ff00";
    ctx.beginPath(); ctx.moveTo(0, -25); ctx.lineTo(-20, 15); ctx.lineTo(0, 5); ctx.lineTo(20, 15); ctx.closePath(); ctx.stroke();
    ctx.restore();
}

class Enemy {
    constructor() {
        this.x = Math.random() * (canvas.width - 60) + 30;
        this.y = -40;
        this.speed = 2.5 + (score / 1000);
    }
    draw() { ctx.font = "28px Arial"; ctx.fillText("üëæ", this.x - 14, this.y); }
}

class Bullet {
    constructor(x, y) { this.x = x; this.y = y - 25; this.speed = 22; }
    draw() { ctx.fillStyle = "#00ff00"; ctx.fillRect(this.x - 1, this.y, 2, 20); }
}

window.addEventListener('keydown', (e) => { if(e.code === "Space" && gameActive) shoot(); });
canvas.addEventListener('mousedown', () => { if(gameActive) shoot(); });
function shoot() { bullets.push(new Bullet(mouseX, mouseY)); }

function gameLoop() {
    ctx.fillStyle = "rgba(0, 0, 0, 0.3)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    if(gameActive) {
        drawShip(mouseX, mouseY);
        if(Math.random() < 0.07) enemies.push(new Enemy());
        bullets.forEach((b, bi) => {
            b.y -= b.speed; b.draw();
            if(b.y < 0) bullets.splice(bi, 1);
            enemies.forEach((e, ei) => {
                if(Math.hypot(e.x - b.x, e.y - b.y) < 35) {
                    enemies.splice(ei, 1); bullets.splice(bi, 1);
                    score += 10; document.getElementById('score').innerText = score.toString().padStart(4, '0');
                }
            });
        });
        enemies.forEach((e, i) => {
            e.y += e.speed; e.draw();
            if(e.y > canvas.height) {
                enemies.splice(i, 1); leaks++;
                document.getElementById('leaks').innerText = leaks;
                if(leaks >= 10) systemReboot();
            }
        });
    }
    requestAnimationFrame(gameLoop);
}

function systemReboot() {
    gameActive = false;
    logTerminal("[!] DEFENSE BREACHED. REBOOTING UNIT...");
    document.getElementById('hud').style.display = 'none';
    document.getElementById('ui-controls').style.display = 'none';
    const startScreen = document.getElementById('start-screen');
    startScreen.style.display = 'block'; startScreen.style.opacity = '1';
    leaks = 0; score = 0; enemies = []; bullets = [];
    document.getElementById('score').innerText = "0000";
    document.getElementById('leaks').innerText = "0";
}

function logTerminal(msg) {
    const p = document.createElement('p'); p.className = 'terminal-line';
    p.textContent = `> ${msg}`;
    const term = document.getElementById('terminal');
    term.appendChild(p); term.scrollTop = term.scrollHeight;
    setTimeout(() => p.remove(), 8000);
}

const startAction = () => {
    if(gameActive) return;
    document.getElementById('start-screen').style.opacity = '0';
    setTimeout(() => {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('hud').style.display = 'block';
        document.getElementById('ui-controls').style.display = 'flex';
        gameActive = true;
        logTerminal("SOPHOS INTERCEPTOR READY.");
    }, 500);

    fetch('https://jbrasillabs-1.onrender.com/geoip')
        .then(r => r.json())
        .then(data => {
            logTerminal(`[SOC] SESSION DETECTED: ${data.entry}`);
            fetch('https://jbrasillabs-1.onrender.com/log', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ entry: data.entry })
            });
        }).catch(() => logTerminal("[!] SOPHOS SECURE NODE ACTIVE"));
};

document.getElementById('main-logo').addEventListener('click', startAction);
document.getElementById('start-btn').addEventListener('click', startAction);
gameLoop();
</script>
</body>
</html>
